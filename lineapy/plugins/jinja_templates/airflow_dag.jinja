{% extends "base_dag.jinja" %}
{% block import_block %}{{ import_block }}{% endblock %}

{% block plugin_import_block %}
from airflow import DAG
from airflow.utils.dates import days_ago
from airflow.operators.python_operator import PythonOperator
{% endblock %}

{% block plugin_dag_block %}
default_dag_args = {"owner": "airflow", "retries": 2, "start_date": days_ago(1)}

dag = DAG(
    dag_id="{{ DAG_NAME }}_dag",
    schedule_interval="*/15 * * * *",  # Every 15 minutes
    max_active_runs=1,
    catchup=False,
    default_args=default_dag_args,
)
{% endblock %}

{% block plugin_tasks_block %}
{{ TASK_NAME }} = PythonOperator(
    dag=dag, task_id="{{ TASK_NAME }}_task", python_callable={{ TASK_NAME }},
)
{% endblock %}

