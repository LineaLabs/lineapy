# Be sure to build this docker file with the following command
# docker build -t :lineapy -f _Dockerfile .

FROM python:3.9

RUN mkdir /tmp/installers
WORKDIR /tmp/installers

# Copy all the requirements to run current DAG
COPY ./_requirements.txt ./

# Install required libs
RUN pip install -r ./_requirements.txt

WORKDIR /opt/argo/dags

# Install git and argo
RUN apt update
RUN apt install -y git
RUN pip install argo-workflows
RUN pip install hera-workflows

COPY ./_module.py ./
COPY ./_dag.py ./

ENTRYPOINT [ "argo", "repro", "run_all_sessions"]