import pandas


def get_df():
    df = pandas.DataFrame({"a": [1, 2]})
    return df


def get_df2(df):
    df2 = pandas.concat([df, df])
    return df2


def run_session_including_df():
    # Given multiple artifacts, we need to save each right after
    # its calculation to protect from any irrelevant downstream
    # mutations (e.g., inside other artifact calculations)
    import copy

    artifacts = []
    df = get_df()
    artifacts.append(copy.deepcopy(df))
    df2 = get_df2(df)
    artifacts.append(copy.deepcopy(df2))
    return artifacts


def run_all_sessions():
    df, df2 = run_session_including_df()
    return df, df2


if __name__ == "__main__":
    run_all_sessions()
