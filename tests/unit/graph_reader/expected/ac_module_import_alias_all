import pandas as pd


def get_df():
    df = pd.DataFrame({"a": [1, 2]})
    return df


def get_df2(df):
    df2 = pd.concat([df, df])
    return df2


def run_session_including_df():
    # Given multiple artifacts, we need to save each right after
    # its calculation to protect from any irrelevant downstream
    # mutations (e.g., inside other artifact calculations)
    import copy

    artifacts = dict()
    df = get_df()
    artifacts["df"] = copy.deepcopy(df)
    df2 = get_df2(df)
    artifacts["df2"] = copy.deepcopy(df2)
    return artifacts


def run_all_sessions():
    artifacts = dict()
    artifacts.update(run_session_including_df())
    return artifacts


if __name__ == "__main__":
    run_all_sessions()
